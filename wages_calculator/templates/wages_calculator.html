{% extends "std_template.html" %}


{% block standard_title %}WAGES CALCULATOR{% endblock %}

    {% block standard_content %}
        <div class="row center-align">
            <div class="col s12 m8 offset-m2 xl6 content-container" >
                <form action="" method="post">

                    <!-- date -->
                    <div class="row">
                        <div class="input-field col s12">
                            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
                            <input id="wages_date" name="search_date"  type="text" class="datepicker validate" required>
                            <label for="wages_date">Start date:</label>
                        </div>
                    </div>

                    <!-- driver -->
                    <div class="row">
                        <div class="input-field col s12">
                            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
                            <select name="search_driver_id" id="driver_id" class="validate" required>
                                <option value="" disabled selected>Choose driver</option>
                                {% for driver in drivers %}
                                    <option value="{{ driver.id }}" >{{ driver.name() }}</option>
                                {% endfor %}   
                            </select>
                            <label for="driver_id">Select Driver:</label>
                        </div>
                    </div>

                    <!-- buttons -->
                    <div class="row">
                        <div class="input-field col s12 center-align">
                            <button type="submit" class="btn green accent-4 submit">Search </button>
                            <button href="{{ url_for('wages_calculator')}}" class="btn grey" formnovalidate>Reset</button>
                        </div>   
                    </div>
                </form>
            </div>
            <div class="col s12 m8 offset-m2 xl6 content-container">
                {% if day_end_entries == [] %}
                <div class="">
                    <h4 class="center-align">No results for the date and driver selected.</h4>  
                    <h5 class="center-align"><a href="{{ url_for('add_day_end') }}">Click here to check history.</a></h5>  
                </div>
                {% elif day_end_entries is defined %}
                    <table class="centered responsive-table">
                        <thead>
                          <tr>
                              <th>Date</th>
                              <th>Earned</th>
                              <th>Wage</th>
                              <th>Overnight</th>
                          </tr>
                        </thead>
                
                        <tbody>
                            {% for day in day_end_entries %}    
                            <tr>
                                <td>{{ day.date }}</td>
                                <td>{{ format_currency(currency_to_web(day.earned)) }}</td>
                                <td>{{ format_currency(day.driver.bonus_percentage * currency_to_web(day.earned)) }}</td>
                                <td>{{ "y" if day.overnight == True else "n" }}</td>
                            </tr>
                            {% endfor %}
                            <tr class="table-breaker">
                                
                            </tr>
                            <tr class="totals-row">
                                <td><em>Totals:</em></td>
                                <td><em>{{ format_currency(currency_to_web(total_earned)) }}</em></td>
                                <td><em>{{ format_currency(currency_to_web(bonus_wage)) }}</em></td>
                                <td><em>{{ format_currency(currency_to_web(total_overnight)) }}</em></td>
                            </tr>
                        </tbody>
                    </table> 
                    <br>
                    <br>
                    
                    <table class="centered">
                        <thead>
                            <tr>
                                <th>Base wage</th>
                                <th>Wages total</th>
                            </tr>
                            <tbody>    
                                <tr>
                                    <td>{{ format_currency(currency_to_web(base_wage)) }}</td>
                                    <td>{{ format_currency(currency_to_web(total_wages)) }}</td>
                                </tr>
                            </tbody>
                        </table> 
                                
                {% else %}
                
                <div class="">
                    <h4 class="center-align">Please select a date and driver.</h4>  
                    <h5 class="center-align">(Weeks begin Monday and end Sunday)</h5>  
                </div>

                        
                {% endif %}
            </div>
        </div>
    {% endblock %}
